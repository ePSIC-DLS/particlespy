

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Segmentation &mdash; ParticleSpy 0.4.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Particle Analysis" href="particle_analysis.html" />
    <link rel="prev" title="Getting started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ParticleSpy
          

          
          </a>

          
            
            
              <div class="version">
                0.4.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Segmentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-a-pre-segmented-mask">Using a Pre-Segmented Mask</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-segmentation-user-interface">Using the Segmentation User Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parameter-picking-for-automated-segmentation">Parameter Picking for Automated Segmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manual-segmentation">Manual Segmentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="particle_analysis.html">Particle Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting_saving.html">Plotting and Saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="time_series.html">Time Series</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ParticleSpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Segmentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/segmentation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="segmentation">
<span id="id1"></span><h1>Segmentation<a class="headerlink" href="#segmentation" title="Permalink to this headline">¶</a></h1>
<p>ParticleSpy provides different options for the segmentation of particles from images.</p>
<div class="section" id="using-a-pre-segmented-mask">
<h2>Using a Pre-Segmented Mask<a class="headerlink" href="#using-a-pre-segmented-mask" title="Permalink to this headline">¶</a></h2>
<p>The most straightforward method is to supply ParticleSpy with a pre-segmented mask (boolean image).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ParticleAnalysis</span><span class="p">(</span><span class="n">acquisition</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">numpy</span> <span class="n">array</span> <span class="n">containg</span> <span class="n">mask</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>In this way other software (e.g. ImageJ) could be used to perform segmentation which is then used by ParticleSpy to segment particles.</p>
</div>
<div class="section" id="using-the-segmentation-user-interface">
<h2>Using the Segmentation User Interface<a class="headerlink" href="#using-the-segmentation-user-interface" title="Permalink to this headline">¶</a></h2>
<p>ParticleSpy can also perform its own segmentation either using automated functions from scikit-image or using a fully manual approach.
In order to assist with both methods, ParticleSpy provides a Segmentation User Interface.
This can be launched from a python kernel using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">SegUI()</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">SegUI</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="parameter-picking-for-automated-segmentation">
<h3>Parameter Picking for Automated Segmentation<a class="headerlink" href="#parameter-picking-for-automated-segmentation" title="Permalink to this headline">¶</a></h3>
<p>Once the Segmentation User Interface is launched the ‘Auto’ panel is displayed.
This panel provides a number of options that can be tuned to provide an optimal automated segmentation.
Once you have chosen your parameters, pressing ‘Update’ will display a segmented image.
‘Update’ will also save the current parameters to use later.</p>
<img alt="_images/segui.png" class="align-center" src="_images/segui.png" />
<p>The parameters for the automated segmentation are described here:</p>
<ol class="arabic simple">
<li><p>Rolling ball size</p></li>
</ol>
<p>The rolling ball algorithm is equivalent to a top hat filter. It acts to remove slowly varying background intensity at a size larger than the particle diameter. The default is to not apply a rolling ball (value = 0). To apply a rolling ball enter a value (in pixels) that is significantly larger than your particle diameter.</p>
<ol class="arabic simple" start="2">
<li><p>Gaussian filter kernel</p></li>
</ol>
<p>This is an option to apply a Gaussian filter to the image before segmentation, to assisst with noisy data. Typically, a value of 1 - 3 works well.</p>
<ol class="arabic simple" start="3">
<li><p>Thresholding options</p></li>
</ol>
<p>Here are a series of algorithms for determining thresholds at which to segment. Most of the options available in scikit-image are included, including the popular Otsu, Isodata and Li methods. From Otsu to Li are all global methods and will set one threshold value for the whole image. Below Li are local methods that will set threshold values that change over the image. Local and local Otsu work slightly differently but will provide a segmentation in which variations in intensity across an image are taken in to account. Local + Global Otsu performs both local and global thresholding.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Methods using the Local Otsu may take a long time on large images.</p>
</div>
<ol class="arabic simple" start="4">
<li><p>Local filter kernel</p></li>
</ol>
<p>Select the size of the local filter kernel to use if using one of the local thresholding methods. A value between 2 - 10 times smaller than the image may work.</p>
<ol class="arabic simple" start="5">
<li><p>Watershed</p></li>
</ol>
<p>Tick to apply a watershed step to the segmented labels. This acts to separate touching objects. The watershed algorithm uses local maxima of the distance transform as seeds, the minimum separation of these local maxima is set by the min particle size option.</p>
<ol class="arabic simple" start="6">
<li><p>Invert</p></li>
</ol>
<p>Option to invert the image intensity when using a bright field image.</p>
<ol class="arabic simple" start="7">
<li><p>Min particle size</p></li>
</ol>
<p>This parameter has two uses. Firstly, it acts to remove any labels (objects) that have an area (in pixels) below this value. Secondly, it acts as the minimum separation for seeds in the watershed algorithm.</p>
<ol class="arabic simple" start="8">
<li><p>Update</p></li>
</ol>
<p>Updates the displayed image with the current parameters and updates the current parameters file.</p>
<ol class="arabic simple" start="9">
<li><p>Get Params</p></li>
</ol>
<p>Prints the current parameters as output for reference.</p>
<ol class="arabic simple" start="10">
<li><p>Display</p></li>
</ol>
<p>Option to display either the image with label boundaries displayed, or the solid labels coloured by label number.</p>
</div>
<div class="section" id="manual-segmentation">
<h3>Manual Segmentation<a class="headerlink" href="#manual-segmentation" title="Permalink to this headline">¶</a></h3>
<p>The second tab in the Segmentation User Interface provides an option to manually segment an individual image.
You can get to this tab by clicking ‘Manual’ in the top bar.</p>
<p>Here, segmentation works by holding the left mouse button and drawing around the outside of a particle.
Once you have completely enclosed the particle, release the left mouse button.
If you are happy with your particle boundary, click on the particle centre with the right mouse button.
You may notice the middle of the particle turn slightly blue (can be difficult to see).
Continue to segment all of the particles in the image in this way until all are segmented.</p>
<p>Once you have segmented all of the particles, click ‘Save Segmentation’.
This will save the generated segmentation as an internal npy file that can be read when using <code class="xref py py-meth docutils literal notranslate"><span class="pre">ParticleAnalysis()</span></code>.</p>
<img alt="_images/manual_segui.png" class="align-center" src="_images/manual_segui.png" />
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do NOT right-click on any part of the image that is not fully enclosed by a red circle.
Doing so will ruin the segmentation and you will have to reload SegUI.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="particle_analysis.html" class="btn btn-neutral float-right" title="Particle Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, ePSIC

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>